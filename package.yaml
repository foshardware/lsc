# Copyright 2018 - Andreas Westerwick <westerwick@pconas.de>
# SPDX-License-Identifier: GPL-3.0-or-later

name:                lsc
version:             0.2.4.0
github:              "foshardware/lsc"
license:             GPL-3
author:              "Andreas Westerwick"
maintainer:          "westerwick@pconas.de"
copyright:           "2019 Andreas Westerwick"
build-type:          Custom

flags:
  glpk:
    default: false
    manual: false
  debug:
    default: false
    manual: false

extra-source-files:
- README.md

custom-setup:
  dependencies:
  - base >= 4.9.1 && < 5
  - file-embed
  - filepath
  - Cabal
  - process

dependencies:
- base >= 4.9.1 && < 5
- aeson
- array
- arrowgant
- async
- blaze-svg
- blif
- bytestring
- cabal-file-th
- cereal
- concurrent-output
- containers >= 0.5.8
- cond
- data-default
- deepseq
- entropy
- file-embed
- filepath
- firrtl
- hashable
- hashtables
- kan-extensions
- lefdef
- lens
- linear
- matrix
- mmorph
- monad-loops
- mtl
- mwc-random
- parallel
- parsec
- parsec-numbers
- pointed
- pretty-terminal
- primitive
- SafeSemaphore
- split
- tasty
- tasty-hunit
- tasty-quickcheck
- template-haskell
- text
- time
- unordered-containers
- vector
- vector-algorithms
- verilog


library:
  source-dirs: src
  ghc-options:
  - -Wall
  when:
  - condition: flag(glpk)
    dependencies:
    - glpk-hs
    cpp-options:
    - -DGLPK
    ghc-options:
    - -O2
  - condition: flag(debug)
    then:
      cpp-options:
      - -DDEBUG
      ghc-options:
      - -g
      - -dcore-lint
      - -debug
    else:
      ghc-options:
      - -O2

executables:
  lsc:
    main:                Main.hs
    source-dirs:         app
    dependencies:
    - lsc
    ghc-options:
    - -Wall
    - -rtsopts
    when:
    - condition: flag(debug)
      then:
        cpp-options:
        - -DDEBUG
        ghc-options:
        - -g
        - -dcore-lint
        - -debug
      else:
        ghc-options:
        - -O2
        - -threaded

tests:
  lsc-test:
    main:                Spec.hs
    source-dirs:         test
    dependencies:
    - lsc
    ghc-options:
    - -Wall
    - -rtsopts
    when:
    - condition: flag(debug)
      then:
        cpp-options:
        - -DDEBUG
        ghc-options:
        - -g
        - -dcore-lint
        - -debug
      else:
        ghc-options:
        - -O
        - -threaded

